<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>SecrÃ©taire GÃ©nÃ©ral â€“ LISCA</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<div class="layout">

    <!-- SIDEBAR -->
    <div class="sidebar">
        <h2>SG â€“ LISCA</h2>
        <ul>
            <li>ğŸ“ Dossiers</li>
            <li>ğŸ§‘â€âš•ï¸ DÃ©pistages</li>
            <li>ğŸ¤ Partenariats</li>
            <li>ğŸ“… Rendez-vous</li>
            <li>ğŸ“„ Rapport PDF</li>
        </ul>
    </div>

    <!-- CONTENT -->
    <div class="content">
        <div class="topbar">
            <h1>Tableau de bord â€“ SG</h1>
            <div>{{ user }}</div>
        </div>

        <!-- DOSSIERS -->
        <div class="panel">
            <h2>Dossiers patients</h2>
            <table>
                <tr>
                    <th>Patient</th>
                    <th>Cancer</th>
                    <th>Urgent</th>
                    <th>Statut</th>
                    <th>Action</th>
                </tr>
                {% for d in dossiers %}
                <tr>
                    <td>{{ d.nom }}</td>
                    <td>{{ d.type_cancer }}</td>
                    <td>{{ d.urgent }}</td>
                    <td>{{ d.statut }}</td>
                    <td>
                        {% if d.statut == "EN_ATTENTE" %}
                        <form method="post" action="/sg/statut" style="display:inline;">
                            <input type="hidden" name="dossier_id" value="{{ d.id }}">
                            <input type="hidden" name="user" value="{{ user }}">
                            <input type="hidden" name="statut" value="VALIDE">
                            <button>âœ… Valider</button>
                        </form>
                        <form method="post" action="/sg/statut" style="display:inline;">
                            <input type="hidden" name="dossier_id" value="{{ d.id }}">
                            <input type="hidden" name="user" value="{{ user }}">
                            <input type="hidden" name="statut" value="REJETE">
                            <button>âŒ Rejeter</button>
                        </form>
                        {% else %}
                        â€”
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </table>
        </div>

        <!-- DEPISTAGES -->
        <div class="panel" style="margin-top:30px;">
            <h2>DÃ©pistages (MÃ©decins)</h2>
            <table>
                <tr>
                    <th>Patient</th>
                    <th>Type</th>
                    <th>RÃ©sultat</th>
                    <th>MÃ©decin</th>
                </tr>
                {% for d in depistages %}
                <tr>
                    <td>{{ d.patient }}</td>
                    <td>{{ d.type_depistage }}</td>
                    <td>{{ d.resultat }}</td>
                    <td>{{ d.medecin }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>

        <!-- PARTENARIATS -->
        <div class="panel" style="margin-top:30px;">
            <h2>Partenariats</h2>

            <form method="post" action="/sg/partenariat">
                <input type="hidden" name="user" value="{{ user }}">
                <input type="text" name="nom" placeholder="Nom du partenaire" required>
                <input type="text" name="type" placeholder="Type (ONG, Ã‰tat, Cliniqueâ€¦)" required>
                <input type="text" name="contact" placeholder="Contact" required>
                <button type="submit">â• Ajouter</button>
            </form>

            <table style="margin-top:15px;">
                <tr>
                    <th>Nom</th>
                    <th>Type</th>
                    <th>Contact</th>
                </tr>
                {% for p in partenariats %}
                <tr>
                    <td>{{ p.nom }}</td>
                    <td>{{ p.type }}</td>
                    <td>{{ p.contact }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>

        <!-- RENDEZ-VOUS -->
        <div class="panel" style="margin-top:30px;">
            <h2>Rendez-vous</h2>
            <table>
                <tr>
                    <th>Titre</th>
                    <th>Date</th>
                    <th>CrÃ©Ã© par</th>
                </tr>
                {% for r in rdv %}
                <tr>
                    <td>{{ r.titre }}</td>
                    <td>{{ r.date }}</td>
                    <td>{{ r.acteur }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>

        <!-- PDF -->
        <div class="panel" style="margin-top:30px; text-align:right;">
            <a href="/rapport/pdf" target="_blank">
                ğŸ“„ TÃ©lÃ©charger le rapport global PDF
            </a>
        </div>

    </div>
</div>

</body>
</html>
